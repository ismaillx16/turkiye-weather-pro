<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TÃ¼rkiye Hava Durumu</title>
    <!-- Tailwind CSS'i projeye dahil ediyoruz -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts'tan Inter fontunu kullanÄ±yoruz -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* SayfanÄ±n genel fontunu belirliyoruz */
        body {
            font-family: 'Inter', sans-serif;
            background-size: cover;
            background-position: center;
            background-image: url('https://images.unsplash.com/photo-1499346030926-9a72daac6c63?q=80&w=2070&auto=format&fit=crop');
        }
        
        /* Animasyon iÃ§in spinner */
        .loader {
            border: 4px solid #f3f3f3; border-radius: 50%; border-top: 4px solid #3498db; width: 40px; height: 40px;
            -webkit-animation: spin 2s linear infinite; animation: spin 2s linear infinite;
        }
        @-webkit-keyframes spin { 0% { -webkit-transform: rotate(0deg); } 100% { -webkit-transform: rotate(360deg); } }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>

    <div class="flex items-center justify-center min-h-screen w-full h-full p-4 bg-black/25">
        <div class="w-full max-w-7xl space-y-4">
            <!-- Ana Form -->
            <div class="bg-white/40 backdrop-blur-xl p-8 rounded-2xl shadow-2xl w-full border border-white/20 flex flex-col">
                <div class="flex-grow flex flex-col md:flex-row gap-8">
                    <!-- Sol Panel: Ana Bilgiler -->
                    <div class="w-full md:w-1/4 flex flex-col justify-between">
                        <div>
                            <h1 class="text-3xl font-bold text-gray-800">TÃ¼rkiye Hava Durumu</h1>
                            <p class="text-gray-700">Bir ÅŸehir seÃ§in ve hava durumunu Ã¶ÄŸrenin.</p>
                        </div>
                        <!-- Åehir SeÃ§im AlanÄ± -->
                        <div class="my-auto">
                            <label for="cityDropdown" class="block mb-2 text-sm font-medium text-gray-900">Åehir SeÃ§in</label>
                            <select id="cityDropdown" class="bg-white/50 border border-white/30 text-gray-800 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 backdrop-blur-sm">
                                <!-- Åehirler buraya JS ile eklenecek -->
                            </select>
                        </div>
                         <!-- Buton -->
                        <button id="getInfoBtn" class="w-full bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-4 rounded-lg transition duration-300 ease-in-out transform hover:scale-105">
                            HAVA NASIL?
                        </button>
                    </div>

                    <!-- SaÄŸ Panel: DetaylÄ± Bilgiler ve Grafikler -->
                    <div id="weatherResult" class="w-full md:w-3/4">
                        <!-- Hava durumu sonuÃ§larÄ± buraya gelecek -->
                    </div>
                </div>
            </div>
            <!-- Saatlik Tahmin Paneli -->
            <div id="hourlyForecastContainer" class="bg-white/40 backdrop-blur-xl p-4 rounded-2xl shadow-2xl w-full border border-white/20 hidden">
                <!-- Saatlik tahmin buraya gelecek -->
            </div>
            <!-- Tavsiye Formu -->
            <div id="adviceResult" class="bg-white/40 backdrop-blur-xl p-4 rounded-2xl shadow-2xl w-full border border-white/20 hidden">
                 <!-- Tavsiyeler buraya gelecek -->
            </div>
        </div>
    </div>

    <!-- Ä°mza AlanÄ± -->
    <div class="fixed bottom-4 right-4 text-sm text-white/70 font-light">
        Created by Ä°smail
    </div>

    <script>
        // --- API ANAHTARI (API KEY) ---
        const weatherApiKey = "047c68cff08a43a3b48120742252907";

        const cities = [
            "Adana", "AdÄ±yaman", "Afyonkarahisar", "AÄŸrÄ±", "Amasya", "Ankara", "Antalya", "Artvin", "AydÄ±n", "BalÄ±kesir",
            "Bilecik", "BingÃ¶l", "Bitlis", "Bolu", "Burdur", "Bursa", "Ã‡anakkale", "Ã‡ankÄ±rÄ±", "Ã‡orum", "Denizli",
            "DiyarbakÄ±r", "Edirne", "ElazÄ±ÄŸ", "Erzincan", "Erzurum", "EskiÅŸehir", "Gaziantep", "Giresun", "GÃ¼mÃ¼ÅŸhane",
            "Hakkari", "Hatay", "Isparta", "Mersin", "Ä°stanbul", "Ä°zmir", "Kars", "Kastamonu", "Kayseri", "KÄ±rklareli",
            "KÄ±rÅŸehir", "Kocaeli", "Konya", "KÃ¼tahya", "Malatya", "Manisa", "KahramanmaraÅŸ", "Mardin", "MuÄŸla", "MuÅŸ",
            "NevÅŸehir", "NiÄŸde", "Ordu", "Rize", "Sakarya", "Samsun", "Siirt", "Sinop", "Sivas", "TekirdaÄŸ", "Tokat",
            "Trabzon", "Tunceli", "ÅanlÄ±urfa", "UÅŸak", "Van", "Yozgat", "Zonguldak", "Aksaray", "Bayburt", "Karaman",
            "KÄ±rÄ±kkale", "Batman", "ÅÄ±rnak", "BartÄ±n", "Ardahan", "IÄŸdÄ±r", "Yalova", "KarabÃ¼k", "Kilis", "Osmaniye", "DÃ¼zce"
        ];
        cities.sort((a, b) => a.localeCompare(b, 'tr'));

        const cityDropdown = document.getElementById('cityDropdown');
        const getInfoBtn = document.getElementById('getInfoBtn');
        const weatherResult = document.getElementById('weatherResult');
        const adviceResult = document.getElementById('adviceResult');
        const hourlyForecastContainer = document.getElementById('hourlyForecastContainer');
        
        let fullForecastData = null; // TÃ¼m tahmin verisini saklamak iÃ§in

        function populateCityDropdown() {
            cities.forEach(city => {
                const option = document.createElement('option');
                option.value = city;
                option.textContent = city;
                cityDropdown.appendChild(option);
            });
        }

        function showLoading(element) {
            element.innerHTML = `<div class="flex items-center justify-center h-full"><div class="loader"></div></div>`;
        }
        
        function showError(element, title, message) {
             element.innerHTML = `<div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg h-full flex flex-col justify-center"><strong class="font-bold">${title}</strong><span class="block sm:inline">${message}</span></div>`;
        }
        
        function normalizeCityNameForAPI(city) {
            return city.replace(/Ã‡/g, 'C').replace(/Ã§/g, 'c').replace(/Ä/g, 'G').replace(/ÄŸ/g, 'g').replace(/Ä°/g, 'I').replace(/Ä±/g, 'i').replace(/Ã–/g, 'O').replace(/Ã¶/g, 'o').replace(/Å/g, 'S').replace(/ÅŸ/g, 's').replace(/Ãœ/g, 'U').replace(/Ã¼/g, 'u');
        }

        async function fetchWeather() {
            if (weatherApiKey === "SENÄ°N_WEATHERAPI_KEYÄ°NÄ°_BURAYA_YAPIÅTIR" || weatherApiKey === "") {
                showError(weatherResult, 'API AnahtarÄ± Eksik!', 'LÃ¼tfen WeatherAPI.com API anahtarÄ±nÄ± koda ekleyin.');
                return;
            }
            const city = cityDropdown.value;
            showLoading(weatherResult);
            adviceResult.classList.add('hidden');
            hourlyForecastContainer.classList.add('hidden');

            const normalizedCity = normalizeCityNameForAPI(city);
            const apiUrl = `https://api.weatherapi.com/v1/forecast.json?key=${weatherApiKey}&q=${normalizedCity}&days=4&aqi=yes&alerts=no&lang=tr`;
            
            try {
                const response = await fetch(apiUrl);
                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.error.message || 'Veri alÄ±namadÄ±.');
                }
                const data = await response.json();
                fullForecastData = data.forecast.forecastday; // Veriyi global deÄŸiÅŸkene kaydet
                displayWeather(data, city);
                displayAdvice(data);
            } catch (error) {
                console.error("Hava durumu hatasÄ±:", error);
                showError(weatherResult, 'Hava Durumu HatasÄ±', error.message);
            }
        }
        
        function getUvIndexBar(uv) {
            const uvValue = parseFloat(uv);
            let color = 'bg-green-500';
            if (uvValue > 2) color = 'bg-yellow-500';
            if (uvValue > 5) color = 'bg-orange-500';
            if (uvValue > 7) color = 'bg-red-500';
            if (uvValue > 10) color = 'bg-purple-500';
            const width = Math.min((uvValue / 11) * 100, 100);
            return `<div class="w-full bg-gray-200 rounded-full h-2.5"><div class="${color} h-2.5 rounded-full" style="width: ${width}%"></div></div>`;
        }

        function getAirQualityBar(index) {
            const aqValue = parseInt(index);
            let color = 'bg-green-500'; // Ä°yi
            if (aqValue === 2) color = 'bg-yellow-400'; // Orta
            if (aqValue === 3) color = 'bg-orange-500'; // Hassas gruplar iÃ§in saÄŸlÄ±ksÄ±z
            if (aqValue === 4) color = 'bg-red-500'; // SaÄŸlÄ±ksÄ±z
            if (aqValue >= 5) color = 'bg-purple-700'; // Ã‡ok saÄŸlÄ±ksÄ±z / Tehlikeli
            const width = (aqValue / 6) * 100;
            return `<div class="w-full bg-gray-200 rounded-full h-2.5"><div class="${color} h-2.5 rounded-full" style="width: ${width}%"></div></div>`;
        }

        function getProgressBar(value) {
             return `<div class="w-full bg-gray-200 rounded-full h-2.5"><div class="bg-blue-400 h-2.5 rounded-full" style="width: ${value}%"></div></div>`;
        }

        function getWindDetails(direction) {
            const directions = { 'N': { turkce: 'Kuzey', derece: 0 }, 'NNE': { turkce: 'KuzeydoÄŸu', derece: 22.5 }, 'NE': { turkce: 'KuzeydoÄŸu', derece: 45 }, 'ENE': { turkce: 'KuzeydoÄŸu', derece: 67.5 }, 'E': { turkce: 'DoÄŸu', derece: 90 }, 'ESE': { turkce: 'GÃ¼neydoÄŸu', derece: 112.5 }, 'SE': { turkce: 'GÃ¼neydoÄŸu', derece: 135 }, 'SSE': { turkce: 'GÃ¼neydoÄŸu', derece: 157.5 }, 'S': { turkce: 'GÃ¼ney', derece: 180 }, 'SSW': { turkce: 'GÃ¼neybatÄ±', derece: 202.5 }, 'SW': { turkce: 'GÃ¼neybatÄ±', derece: 225 }, 'WSW': { turkce: 'GÃ¼neybatÄ±', derece: 247.5 }, 'W': { turkce: 'BatÄ±', derece: 270 }, 'WNW': { turkce: 'KuzeybatÄ±', derece: 292.5 }, 'NW': { turkce: 'KuzeybatÄ±', derece: 315 }, 'NNW': { turkce: 'KuzeybatÄ±', derece: 337.5 } };
            const details = directions[direction] || { turkce: direction, derece: 0 };
            const arrow = `<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" class="inline-block ml-1" style="transform: rotate(${details.derece}deg);"><path fill="currentColor" d="M12 2L4.5 20.29l.71.71L12 18l6.79 3 .71-.71z"></path></svg>`;
            return { turkce: details.turkce, arrow: arrow };
        }

        function getMoonPhaseInTurkish(englishPhase) {
            const phases = {
                'New Moon': 'Yeni Ay', 'Waxing Crescent': 'Hilal', 'First Quarter': 'Ä°lk DÃ¶rdÃ¼n',
                'Waxing Gibbous': 'BÃ¼yÃ¼yen Kambur Ay', 'Full Moon': 'Dolunay', 'Waning Gibbous': 'KÃ¼Ã§Ã¼len Kambur Ay',
                'Last Quarter': 'Son DÃ¶rdÃ¼n', 'Waning Crescent': 'KÃ¼Ã§Ã¼len Hilal'
            };
            return phases[englishPhase] || englishPhase;
        }

        function formatDateToDayName(dateString) {
            const days = ['Pazar', 'Pazartesi', 'SalÄ±', 'Ã‡arÅŸamba', 'PerÅŸembe', 'Cuma', 'Cumartesi'];
            const date = new Date(dateString);
            return days[date.getDay()];
        }

        function displayAdvice(data) {
            const { current } = data;
            const advices = [];
            if (current.uv >= 8) { advices.push("â˜€ï¸ UV indeksi Ã§ok yÃ¼ksek. 10:00-16:00 arasÄ± dÄ±ÅŸarÄ± Ã§Ä±kmaktan kaÃ§Ä±nÄ±n."); } 
            else if (current.uv >= 6) { advices.push("â˜€ï¸ YÃ¼ksek UV uyarÄ±sÄ±! GÃ¼neÅŸ kreminizi sÃ¼rmeyi unutmayÄ±n."); }
            if (current.gust_kph > 40) { advices.push("ğŸ’¨ Ani ve kuvvetli rÃ¼zgar hamleleri bekleniyor, dikkatli olun."); } 
            else if (current.wind_kph > 30) { advices.push("ğŸ’¨ Åiddetli rÃ¼zgar etkili. DÄ±ÅŸarÄ±dayken dikkatli olun."); }
            if (current.precip_mm > 0.5) { advices.push("â˜” YaÄŸÄ±ÅŸ bekleniyor. Åemsiyenizi yanÄ±nÄ±za almayÄ± unutmayÄ±n."); }
            if (current.temp_c > 30) { advices.push("ğŸ¥µ Hava bunaltÄ±cÄ± derecede sÄ±cak. Bol su iÃ§in."); } 
            else if (current.temp_c < 5) { advices.push("ğŸ¥¶ Hava oldukÃ§a soÄŸuk. Kat kat giyinin."); }
            if (current.vis_km < 1) { advices.push("ğŸŒ«ï¸ GÃ¶rÃ¼ÅŸ mesafesi dÃ¼ÅŸÃ¼k. Trafikte dikkatli olun."); }
            if (current.humidity > 85) { advices.push("ğŸ’§ YÃ¼ksek nem bunaltÄ±cÄ± olabilir."); }
            if (current.pressure_mb < 1005) { advices.push("ğŸ“‰ AlÃ§ak basÄ±nÃ§, hava aniden deÄŸiÅŸebilir."); }
            if (current.air_quality && current.air_quality['us-epa-index'] > 2) { advices.push("ğŸ˜· Hava kalitesi hassas gruplar iÃ§in dÃ¼ÅŸÃ¼k. MÃ¼mkÃ¼nse dÄ±ÅŸarÄ±da az zaman geÃ§irin."); }
            if (advices.length === 0) { advices.push("ğŸ‘ Hava genel olarak sakin ve gÃ¼zel gÃ¶rÃ¼nÃ¼yor. Keyifli bir gÃ¼n dileriz!"); }
            adviceResult.innerHTML = `<div class="flex items-center gap-4"><span class="text-2xl">ğŸ’¡</span><p class="text-gray-700 font-medium">${advices.join(' ')}</p></div>`;
            adviceResult.classList.remove('hidden');
        }

        function showHourlyForecast(dayIndex) {
            if (!fullForecastData) return;
            const dayData = fullForecastData[dayIndex];
            let hourlyHtml = `<h4 class="font-bold text-gray-800 mb-2 text-center col-span-full">${formatDateToDayName(dayData.date)} Saatlik Tahmin</h4>`;
            dayData.hour.forEach(hour => {
                const time = hour.time.split(' ')[1];
                const icon = `https:${hour.condition.icon}`;
                hourlyHtml += `
                    <div class="text-center bg-white/40 p-2 rounded-lg flex-shrink-0 w-24">
                        <p class="font-semibold text-sm">${time}</p>
                        <img src="${icon}" title="${hour.condition.text}" class="w-10 h-10 mx-auto">
                        <p class="text-sm font-bold">${Math.round(hour.temp_c)}Â°C</p>
                        <p class="text-xs text-gray-600">Hiss: ${Math.round(hour.feelslike_c)}Â°</p>
                        <p class="text-xs text-blue-600">YaÄŸmur: %${hour.chance_of_rain}</p>
                    </div>
                `;
            });
            hourlyForecastContainer.innerHTML = `<div class="flex gap-2 overflow-x-auto p-2">${hourlyHtml}</div>`;
            hourlyForecastContainer.classList.remove('hidden');
        }

        function displayWeather(data, cityName) {
            const iconUrl = `https:${data.current.condition.icon}`;
            const wind = getWindDetails(data.current.wind_dir);
            const todayAstro = data.forecast.forecastday[0].astro;
            const airQuality = data.current.air_quality;
            const moonPhaseTurkish = getMoonPhaseInTurkish(todayAstro.moon_phase);

            let forecastHtml = '';
            [1, 2, 3].forEach(i => {
                const day = data.forecast.forecastday[i];
                const dayName = formatDateToDayName(day.date);
                const dayIcon = `https:${day.day.condition.icon}`;
                forecastHtml += `<div class="bg-white/40 p-3 rounded-lg text-center flex-1 cursor-pointer hover:bg-white/60 transition-colors" onclick="showHourlyForecast(${i})">
                        <p class="font-semibold text-sm">${dayName}</p>
                        <img src="${dayIcon}" alt="${day.day.condition.text}" class="w-10 h-10 mx-auto">
                        <p class="text-sm"><span class="font-bold">${Math.round(day.day.maxtemp_c)}Â°</span> / <span class="text-gray-600">${Math.round(day.day.mintemp_c)}Â°</span></p>
                        <p class="text-xs text-blue-600 mt-1">YaÄŸmur: %${day.day.daily_chance_of_rain}</p>
                        <p class="text-xs text-gray-600">RÃ¼zgar: ${Math.round(day.day.maxwind_kph)} km/s</p>
                    </div>`;
            });
            
            weatherResult.innerHTML = `
                <div class="bg-blue-50/60 p-6 rounded-lg border border-white/30 h-full flex flex-col justify-between">
                    <!-- Ãœst KÄ±sÄ±m: AnlÄ±k ve Detaylar -->
                    <div class="flex gap-6">
                        <!-- AnlÄ±k Durum -->
                        <div class="w-1/2">
                            <div class="flex items-center justify-between mb-2">
                                <div>
                                    <h3 class="text-2xl font-bold text-gray-800">${cityName}, TÃ¼rkiye</h3>
                                    <p class="capitalize text-lg text-gray-600">${data.current.condition.text}</p>
                                </div>
                                <img src="${iconUrl}" alt="${data.current.condition.text}" class="w-20 h-20 -mt-4 -mr-2">
                            </div>
                            <div class="flex items-baseline">
                                <p class="text-6xl font-bold text-gray-900">${Math.round(data.current.temp_c)}</p>
                                <span class="text-2xl font-semibold text-gray-700">Â°C</span>
                                <p class="ml-4 text-md text-gray-600">Hissedilen: ${Math.round(data.current.feelslike_c)}Â°C</p>
                            </div>
                            <div class="space-y-2 text-sm mt-4">
                                <p><strong>RÃ¼zgar:</strong> ${data.current.wind_kph} km/s (${wind.turkce} ${wind.arrow})</p>
                                <p><strong>YaÄŸÄ±ÅŸ:</strong> ${data.current.precip_mm} mm</p>
                                <p><strong>GÃ¶rÃ¼ÅŸ:</strong> ${data.current.vis_km} km</p>
                            </div>
                        </div>
                        <!-- DiÄŸer Detaylar ve Grafikler -->
                        <div class="w-1/2 space-y-3 text-sm">
                            <div><div class="flex justify-between"><span class="font-bold">UV Ä°ndeksi:</span><span>${data.current.uv}</span></div>${getUvIndexBar(data.current.uv)}</div>
                            <div><div class="flex justify-between"><span class="font-bold">Hava Kalitesi (US EPA):</span><span>${airQuality['us-epa-index']}</span></div>${getAirQualityBar(airQuality['us-epa-index'])}</div>
                            <div><div class="flex justify-between"><span class="font-bold">Nem:</span><span>%${data.current.humidity}</span></div>${getProgressBar(data.current.humidity)}</div>
                            <div class="grid grid-cols-2 gap-x-2 text-xs pt-1">
                                <p><strong>CO:</strong> ${airQuality.co.toFixed(1)}</p>
                                <p><strong>Oâ‚ƒ:</strong> ${airQuality.o3.toFixed(1)}</p>
                                <p><strong>NOâ‚‚:</strong> ${airQuality.no2.toFixed(1)}</p>
                                <p><strong>SOâ‚‚:</strong> ${airQuality.so2.toFixed(1)}</p>
                            </div>
                        </div>
                    </div>
                    <!-- Alt KÄ±sÄ±m: Tahmin ve Astronomi -->
                    <div class="mt-4 flex flex-col lg:flex-row gap-4">
                        <div class="flex-1">
                            <h4 class="font-bold text-gray-800 mb-2 text-center">3 GÃ¼nlÃ¼k Tahmin (Detay iÃ§in tÄ±klayÄ±n)</h4>
                            <div class="flex gap-2">${forecastHtml}</div>
                        </div>
                        <div class="lg:w-1/3">
                             <h4 class="font-bold text-gray-800 mb-2 text-center">GÃ¶k OlaylarÄ±</h4>
                             <div class="bg-white/40 p-3 rounded-lg text-xs text-gray-700 flex flex-col justify-center space-y-1">
                                <p><strong>â˜€ï¸ GÃ¼n DoÄŸumu:</strong> ${todayAstro.sunrise}</p>
                                <p><strong>ğŸŒ… GÃ¼n BatÄ±mÄ±:</strong> ${todayAstro.sunset}</p>
                                <p><strong>ğŸŒ” Ay DoÄŸuÅŸu:</strong> ${todayAstro.moonrise}</p>
                                <p><strong>ğŸŒ‘ Ay BatÄ±ÅŸÄ±:</strong> ${todayAstro.moonset}</p>
                                <p><strong>ğŸŒ™ Ay Evresi:</strong> ${moonPhaseTurkish}</p>
                             </div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        getInfoBtn.addEventListener('click', fetchWeather);
        populateCityDropdown();
    </script>
</body>
</html>
